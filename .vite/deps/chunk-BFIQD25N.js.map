{
  "version": 3,
  "sources": ["../../node_modules/.pnpm/@babylonjs+core@8.49.1/dev/core/src/Misc/timingTools.ts"],
  "sourcesContent": ["let ImmediateQueue: Array<() => void> = [];\r\n\r\n/**\r\n * Class used to provide helper for timing\r\n */\r\nexport class TimingTools {\r\n    /**\r\n     * Execute a function after the current execution block\r\n     * @param action defines the action to execute after the current execution block\r\n     */\r\n    public static SetImmediate(action: () => void) {\r\n        if (ImmediateQueue.length === 0) {\r\n            setTimeout(() => {\r\n                // Execute all immediate functions\r\n                const functionsToCall = ImmediateQueue;\r\n                ImmediateQueue = [];\r\n\r\n                for (const func of functionsToCall) {\r\n                    func();\r\n                }\r\n            }, 1);\r\n        }\r\n        ImmediateQueue.push(action);\r\n    }\r\n}\r\n\r\nfunction RunWithCondition(condition: () => boolean, onSuccess: () => void, onError?: (e?: any, isTimeout?: boolean) => void) {\r\n    try {\r\n        if (condition()) {\r\n            onSuccess();\r\n            return true;\r\n        }\r\n    } catch (e) {\r\n        onError?.(e);\r\n        return true;\r\n    }\r\n    return false;\r\n}\r\n\r\n/**\r\n * @internal\r\n */\r\nexport const _RetryWithInterval = (\r\n    condition: () => boolean,\r\n    onSuccess: () => void,\r\n    onError?: (e?: any, isTimeout?: boolean) => void,\r\n    step = 16,\r\n    maxTimeout = 30000,\r\n    checkConditionOnCall: boolean = true,\r\n    additionalStringOnTimeout?: string\r\n) => {\r\n    // if checkConditionOnCall is true, we check the condition immediately. If it is true, run everything synchronously\r\n    if (checkConditionOnCall) {\r\n        // that means that one of the two happened - either the condition is true or an exception was thrown when checking the condition\r\n        if (RunWithCondition(condition, onSuccess, onError)) {\r\n            // don't schedule the interval, no reason to check it again.\r\n            return null;\r\n        }\r\n    }\r\n    const int = setInterval(() => {\r\n        if (RunWithCondition(condition, onSuccess, onError)) {\r\n            clearInterval(int);\r\n        } else {\r\n            maxTimeout -= step;\r\n            if (maxTimeout < 0) {\r\n                clearInterval(int);\r\n                onError?.(new Error(\"Operation timed out after maximum retries. \" + (additionalStringOnTimeout || \"\")), true);\r\n            }\r\n        }\r\n    }, step);\r\n    return () => clearInterval(int);\r\n};\r\n"],
  "mappings": ";AAAA,IAAI,iBAAoC,CAAA;AAKlC,IAAO,cAAP,MAAkB;;;;;EAKb,OAAO,aAAa,QAAkB;AACzC,QAAI,eAAe,WAAW,GAAG;AAC7B,iBAAW,MAAK;AAEZ,cAAM,kBAAkB;AACxB,yBAAiB,CAAA;AAEjB,mBAAW,QAAQ,iBAAiB;AAChC,eAAI;QACR;MACJ,GAAG,CAAC;IACR;AACA,mBAAe,KAAK,MAAM;EAC9B;;AAGJ,SAAS,iBAAiB,WAA0B,WAAuB,SAAgD;AACvH,MAAI;AACA,QAAI,UAAS,GAAI;AACb,gBAAS;AACT,aAAO;IACX;EACJ,SAAS,GAAG;AACR,cAAU,CAAC;AACX,WAAO;EACX;AACA,SAAO;AACX;AAKO,IAAM,qBAAqB,CAC9B,WACA,WACA,SACA,OAAO,IACP,aAAa,KACb,uBAAgC,MAChC,8BACA;AAEA,MAAI,sBAAsB;AAEtB,QAAI,iBAAiB,WAAW,WAAW,OAAO,GAAG;AAEjD,aAAO;IACX;EACJ;AACA,QAAM,MAAM,YAAY,MAAK;AACzB,QAAI,iBAAiB,WAAW,WAAW,OAAO,GAAG;AACjD,oBAAc,GAAG;IACrB,OAAO;AACH,oBAAc;AACd,UAAI,aAAa,GAAG;AAChB,sBAAc,GAAG;AACjB,kBAAU,IAAI,MAAM,iDAAiD,6BAA6B,GAAG,GAAG,IAAI;MAChH;IACJ;EACJ,GAAG,IAAI;AACP,SAAO,MAAM,cAAc,GAAG;AAClC;",
  "names": []
}
