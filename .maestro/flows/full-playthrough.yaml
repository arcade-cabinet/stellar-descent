# Full Playthrough Flow - Extended gameplay test
# Cross-platform: Web, Android, iOS
# Note: This is a long-running test for smoke testing full campaign

appId: ${PLATFORM == 'android' ? 'com.jbcom.stellardescent' : (PLATFORM == 'ios' ? 'com.jbcom.stellardescent' : null)}
url: ${PLATFORM == 'web' ? 'http://localhost:8080' : null}
tags:
  - extended
  - playthrough
  - nightly
name: "Full Campaign Playthrough"

---
- launchApp:
    clearState: true

- extendedWaitUntil:
    visible: "NEW CAMPAIGN"
    timeout: 30000

- tapOn:
    text: "NEW CAMPAIGN"

# Wait for initial load
- extendedWaitUntil:
    visible: "SYSTEMS ONLINE"
    timeout: 60000

# Wait for tutorial to start
- extendedWaitUntil:
    visible: "Good morning"
    timeout: 30000

- takeScreenshot: "tutorial_start"

# Skip through tutorial comms
- tapOn:
    text: "ACKNOWLEDGE"
    optional: true

- wait: 1000

- tapOn:
    text: "SKIP"
    optional: true

- wait: 2000

# Basic movement through tutorial
- repeat:
    times: 3
    commands:
      - swipe:
          start: "10%, 70%"
          end: "15%, 60%"
          duration: 2000
      - wait: 500
      - tapOn:
          id: "fire-button"
          optional: true

- takeScreenshot: "tutorial_progress"

# After tutorial, look for level transition
- wait: 5000

# Look for level transition
- assertVisible:
    text: "Landfall"
    optional: true
    timeout: 30000

- takeScreenshot: "level_2_start"

# Basic movement through Landfall
- repeat:
    times: 5
    commands:
      - swipe:
          start: "10%, 70%"
          end: "15%, 60%"
          duration: 3000
      - wait: 1000
      - tapOn:
          id: "fire-button"
          optional: true

- takeScreenshot: "landfall_progress"

# Continue gameplay...
- wait: 10000

- takeScreenshot: "gameplay_checkpoint"
