# Game Loading tests - Full new game flow through mission briefing
# Works on: Web, Android, iOS

appId: "${PLATFORM == 'android' ? 'com.jbcom.stellardescent' : (PLATFORM == 'ios' ? 'com.jbcom.stellardescent' : null)}"
url: "${PLATFORM == 'web' ? WEB_URL : null}"
tags:
  - loading
  - gameplay
name: "Game Loading - New Campaign Flow"

---

- launchApp

# Wait for main menu
- extendedWaitUntil:
    visible: "NEW GAME"
    timeout: 30000

# Start new campaign
- tapOn:
    text: "NEW GAME"

# Handle save overwrite confirmation if it appears
- runFlow:
    when:
      visible: "START NEW"
    commands:
      - tapOn: "START NEW"

# Should see mission select
- extendedWaitUntil:
    visible: "SELECT MISSION"
    timeout: 10000

# Verify campaign chapters are listed
- assertVisible:
    text: "ANCHOR STATION PROMETHEUS"

- assertVisible:
    text: "LANDFALL"

- assertVisible:
    text: "CANYON RUN"

- takeScreenshot: "mission-select"

# Select Anchor Station
- tapOn:
    text: "ANCHOR STATION PROMETHEUS"

# Should see difficulty selection
- extendedWaitUntil:
    visible: "SELECT DIFFICULTY"
    timeout: 10000

- assertVisible:
    text: "EASY"

- assertVisible:
    text: "NORMAL"

- assertVisible:
    text: "HARD"

- assertVisible:
    text: "NIGHTMARE"

- assertVisible:
    text: "ULTRA-NIGHTMARE"

- takeScreenshot: "difficulty-select"

# Start campaign (text includes arrow: "START CAMPAIGN â†’")
- tapOn:
    text: "START CAMPAIGN.*"

# Should see mission briefing
- extendedWaitUntil:
    visible: "MISSION BRIEFING"
    timeout: 10000

- assertVisible:
    text: "ANCHOR STATION PROMETHEUS"

- assertVisible:
    text: "BEGIN MISSION"

# Verify briefing objectives
- assertVisible:
    text: "Complete weapons familiarization"

- assertVisible:
    text: "Navigate to drop pod"

- takeScreenshot: "mission-briefing"
