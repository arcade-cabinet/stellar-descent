# New Game Flow - Starts a new game through to BEGIN MISSION
# Works on: Web, Android, iOS
appId: "${PLATFORM == 'android' ? 'com.jbcom.stellardescent' : (PLATFORM == 'ios' ? 'com.jbcom.stellardescent' : null)}"
url: "${PLATFORM == 'web' ? WEB_URL : null}"
tags:
  - gameplay
  - campaign
  - critical
name: "New Game Start - Campaign Entry"

---
- launchApp

- extendedWaitUntil:
    visible: "NEW GAME"
    timeout: 30000

- tapOn:
    text: "NEW GAME"

# Handle save overwrite confirmation if it appears
- runFlow:
    when:
      visible: "START NEW"
    commands:
      - tapOn: "START NEW"

# Wait for mission select
- extendedWaitUntil:
    visible: "SELECT MISSION"
    timeout: 10000

# Select Anchor Station
- tapOn:
    text: "ANCHOR STATION PROMETHEUS"

# Wait for difficulty screen (Normal is preselected by default)
- extendedWaitUntil:
    visible: "SELECT DIFFICULTY"
    timeout: 10000

# Start campaign
- tapOn:
    text: "START CAMPAIGN.*"

# Wait for mission briefing
- extendedWaitUntil:
    visible: "MISSION BRIEFING"
    timeout: 10000

- takeScreenshot: "mission-briefing"

# Verify BEGIN MISSION button exists
- assertVisible:
    text: "BEGIN MISSION"

- takeScreenshot: "mission-briefing-ready"

# Begin mission
- tapOn:
    text: "BEGIN MISSION"
