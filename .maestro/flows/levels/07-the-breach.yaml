# Campaign Level 7: The Breach
# Underground hive and Queen boss fight
# Cross-platform: Web, Android, iOS

appId: ${PLATFORM == 'android' ? 'com.jbcom.stellardescent' : (PLATFORM == 'ios' ? 'com.jbcom.stellardescent' : null)}
url: ${PLATFORM == 'web' ? 'http://localhost:8080' : null}
tags:
  - campaign
  - level-7
  - hive
  - boss
name: "Campaign Level 7 - The Breach (Queen Boss)"

---
- launchApp:
    clearState: true

# Wait for main menu
- extendedWaitUntil:
    visible: "SELECT MISSION"
    timeout: 30000

# Open level select
- tapOn:
    text: "SELECT MISSION"

- wait: 1000

# Look for The Breach (Chapter 7)
- assertVisible:
    text: "CHAPTER 7"
    optional: true
    timeout: 5000

# Select The Breach if unlocked
- tapOn:
    text: "INTO THE BREACH"
    optional: true

- wait: 500

- takeScreenshot: "level_07_select_state"

# Wait for mission briefing
- assertVisible:
    text: "MISSION BRIEFING"
    optional: true
    timeout: 10000

# Verify mission details
- assertVisible:
    text: "INTO THE BREACH"
    optional: true

- assertVisible:
    text: "Queen"
    optional: true

- assertVisible:
    text: "ACT 3: THE TRUTH"
    optional: true

- takeScreenshot: "level_07_briefing"

# Check intel for Queen boss
- tapOn:
    text: "INTEL"
    optional: true

- wait: 500

# Should show CHITIN QUEEN intel
- assertVisible:
    text: "CHITIN QUEEN"
    optional: true

- assertVisible:
    text: "EXTREME"
    optional: true

- assertVisible:
    text: "HIVE GUARDIAN"
    optional: true

- takeScreenshot: "level_07_intel_queen"

# Verify boss weakness info
- assertVisible:
    text: "egg sacs"
    optional: true

- assertVisible:
    text: "abdomen"
    optional: true

- takeScreenshot: "level_07_intel_weakness"

# Check loadout
- tapOn:
    text: "LOADOUT"
    optional: true

- wait: 500

- assertVisible:
    text: "FLAMETHROWER"
    optional: true

- assertVisible:
    text: "ENHANCED MEDKIT"
    optional: true

- takeScreenshot: "level_07_loadout"

# Begin mission
- tapOn:
    text: "BEGIN MISSION"
    optional: true

# Wait for loading
- extendedWaitUntil:
    visible: "SYSTEMS ONLINE"
    timeout: 60000
    optional: true

- wait: 3000

- takeScreenshot: "level_07_start"

# Hive environment gameplay
- swipe:
    start: "10%, 70%"
    end: "15%, 55%"
    duration: 3000

- takeScreenshot: "level_07_hive_entrance"

# Navigate hive tunnels
- repeat:
    times: 3
    commands:
      - swipe:
          start: "10%, 70%"
          end: "15%, 60%"
          duration: 2000
      - wait: 500
      - swipe:
          start: "80%, 50%"
          end: "75%, 45%"
          duration: 800
      - wait: 300
      - tapOn:
          id: "fire-button"
          optional: true
      - wait: 500

- takeScreenshot: "level_07_hive_combat"

# Continue deeper into hive
- swipe:
    start: "10%, 70%"
    end: "18%, 55%"
    duration: 3000

- wait: 2000

- takeScreenshot: "level_07_gameplay"
